name: CI

on:
  push:
    branches: ["main", "master"]
  pull_request:
    branches: ["main", "master"]

jobs:
  lint-and-parse:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up R
        uses: r-lib/actions/setup-r@v2
        with:
          r-version: '4.3'

      - name: Parse R scripts
        run: |
          Rscript -e "\
            r_files <- list.files('.', pattern = '\\.[rR]$', recursive = TRUE, full.names = TRUE);\
            if (length(r_files) == 0) {\
              message('No R files found');\
              quit(status = 0);\
            }\
            for (f in r_files) {\
              message('Parsing ', f);\
              parse(file = f);\
            }\
          "

      - name: Python syntax check
        run: python -m compileall .
